{# Topic Template #}

<div class="card border-primary mb-2 topic-card" id="topic-card-{{ topic.id }}">
    <div class="card-header">
        <p class="card-text">{{ topic.created_at }}</p>
    </div>
    <div class="card-body">
        <h5 class="card-title">{{ topic.title }}</h5>
        <h6 class="card-subtitle mb-2 text-muted">
            {{ topic.uploader_id }} // youtube
        </h6>
        <div id="youtube-player-{{ topic.id }}"></div>
        <h6 class="card-subtitle mb-2 text-muted">
            Progress: {{ topic.cur_timestamp }} / {{ topic.duration }} ( {{ (topic.cur_timestamp/topic.duration)*100 }} )%
        </h6>
        {# if no extractfiles #}
        <div class="progress mb-2">
            {% if not topic.extractfiles %}
                <div class="progress-bar progress-bar-striped"
                     role="progressbar"
                     style="width: {{ (topic.cur_timestamp/topic.duration)*100 }}%; height: 20px;"
                     aria-valuenow="{{ (topic.cur_timestamp/topic.duration)*100 }}"
                     aria-valuemin="0"
                     aria-valuemax="100">
                </div>
            {% else %}
                <div class="progress-bar progress-bar-striped"
                     role="progressbar"
                     style="width: {{ (topic.extractfiles[0].topicfile_startstamp/topic.duration)*100 }}%; height: 20px;"
                     aria-valuenow="{{ (topic.extractfiles[0].topicfile_startstamp/topic.duration)*100 }}"
                     aria-valuemin="0"
                     aria-valuemax="100">
                </div>
                {% for extract in topic.extractfiles %}
                <div class="progress-bar progress-bar-striped bg-warning"
                     role="progressbar"
                     style="width: {{ ((extract.topicfile_endstamp - extract.topicfile_startstamp)/topic.duration)*100 }}%; height: 20px;"
                     aria-valuenow="{{ ((extract.topicfile_endstamp - extract.topicfile_startstamp)/topic.duration)*100 }}"
                     aria-valuemin="0"
                     aria-valuemax="100"
                     id="extract-bar-{{ extract.id }}">
                </div>
                {% if loop.nextitem is defined %}
                    <div class="progress-bar progress-bar-striped"
                         role="progressbar"
                         style="width: {{ ((loop.nextitem.topicfile_startstamp - extract.topicfile_endstamp)/topic.duration)*100 }}%; height: 20px;"
                         aria-valuenow="{{ ((loop.nextitem.topicfile_startstamp - extract.topicfile_endstamp)/topic.duration)*100 }}"
                         aria-valuemin="0"
                         aria-valuemax="100">
                    </div>
                {% endif %}
                {% endfor %}
                <div class="progress-bar progress-bar-striped"
                     role="progressbar"
                     style="width: {{ ((topic.cur_timestamp - (topic.extractfiles | last).topicfile_endstamp)/topic.duration)*100 }}%; height: 20px;"
                     aria-valuenow="{{ ((topic.cur_timestamp - (topic.extractfiles | last).topicfile_endstamp)/topic.duration)*100 }}"
                     aria-valuemin="0"
                     aria-valuemax="100"
                     id="progress-bar-end">
                </div>
            {% endif %}
        </div>
        <span class="mb-2"><button class="btn btn-primary" id="play">Play</button></span>
        <span class="mb-2"><button class="btn btn-primary" id="pause">Pause</button></span>
        <br></br>
        <p>Speed:</p>
        <span class="mb-2"><button class="btn btn-primary" id="100x">1x</button></span>
        <span class="mb-2"><button class="btn btn-primary" id="150x">1.5x</button></span>
        <div class="card-footer">
            <button class="btn btn-primary">Show extracts</button>
        </div>
    </div>
</div>
